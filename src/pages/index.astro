---
import { getCollection } from 'astro:content';
import BaseHead from '@components/BaseHead.astro';
import Footer from '@components/Footer.astro';
import FormattedDate from '@components/FormattedDate.astro';
import Header from '@components/Header.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '@src/consts';

const posts = (await getCollection('blog')).sort((a, b) => b.data.publishedAt.valueOf() - a.data.publishedAt.valueOf());
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
  <body class="min-h-screen bg-base-950">
    <div class="flex flex-col max-w-7xl mx-auto justify-between min-h-screen">
		  <Header />
      <main class="text-white flex-1 p-4">
        <h3>
          Welcome to SampleUser!
        </h3>
        <section class="py-6">
          <ul>
            {
              posts.map((post) => (
                <li class="py-4 border-b border-base-800">
                  <div class="flex flex-col gap-2">
                    <div class="flex flex-row justify-between items-start">
                      <a href={`/blog/${post.slug}/`} class="hover:text-orange-400 transition-colors">
                        <h4 class="title text-lg font-semibold">{post.data.title}</h4>
                      </a>
                      <p class="text-sm text-base-400">
                        <FormattedDate date={post.data.publishedAt} />
                      </p>
                    </div>
                    {post.data.tags && post.data.tags.length > 0 && (
                      <div class="flex flex-wrap gap-2">
                        {post.data.tags.map((tag) => (
                          <span class="inline-flex items-center rounded-md bg-orange-700/10 px-2 py-1 text-xs  text-orange-700 ring-1 ring-inset ring-orange-700/20">
                            {tag}
                          </span>
                        ))}
                      </div>
                    )}
                  </div>
                </li>
              ))
            }
          </ul>
        </section>
      </main>
      <Footer />
    </div>
	</body>
</html>
